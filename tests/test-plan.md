# IdeaCanvas 系统测试计划

## 测试目标
确保系统在各种边缘情况下的稳定性和可靠性，避免生产环境中的意外错误。

## 测试范围

### 1. JSON 解析测试
- 控制字符处理
- 超长文本处理
- 特殊字符处理
- 格式错误恢复

### 2. AI 响应测试
- 不同语言测试
- 格式变化测试
- 错误响应处理
- 超时处理

### 3. 流程图生成测试
- 节点数量极限测试
- 边缘连接验证
- 循环依赖检测
- 位置计算准确性

### 4. 存储系统测试
- localStorage 配额测试
- 云存储故障恢复
- 数据同步冲突
- 大文件处理

### 5. 用户交互测试
- 并发操作测试
- 快速点击测试
- 网络中断恢复
- 浏览器兼容性

### 6. 性能测试
- 大规模节点渲染
- 内存泄漏检测
- API 响应时间
- 前端渲染性能

## 测试用例详细说明

### JSON 解析边缘情况

#### 测试用例 1: 控制字符
```json
{
  "nodes": [{
    "id": "test1",
    "data": {
      "label": "包含\n换行\r回车\t制表符",
      "content": "第一行\n第二行\n\t缩进内容"
    }
  }]
}
```

#### 测试用例 2: 特殊字符
```json
{
  "nodes": [{
    "id": "test2",
    "data": {
      "label": "包含\"引号\"和\\反斜杠",
      "content": "中文：测试，日文：テスト，韩文：테스트，emoji：😀"
    }
  }]
}
```

#### 测试用例 3: 超长文本
生成包含 10000+ 字符的节点内容

#### 测试用例 4: 嵌套结构
深度嵌套的 JSON 结构测试

### AI 响应异常情况

#### 测试用例 5: 不完整响应
模拟 AI 返回被截断的 JSON

#### 测试用例 6: 格式混乱
模拟 AI 返回包含 markdown 和说明文字的响应

#### 测试用例 7: 编码问题
测试各种字符编码的处理

### 流程图极限测试

#### 测试用例 8: 大规模节点
- 100 个节点
- 500 个边
- 复杂的交叉连接

#### 测试用例 9: 循环依赖
A -> B -> C -> A 的循环结构

#### 测试用例 10: 孤立节点
没有任何连接的独立节点群

### 错误恢复测试

#### 测试用例 11: API 错误
- 401 认证失败
- 403 禁止访问
- 429 速率限制
- 500 服务器错误
- 网络超时

#### 测试用例 12: 存储错误
- localStorage 已满
- 云存储不可用
- 数据损坏

### 并发和性能测试

#### 测试用例 13: 快速操作
- 连续快速生成 10 个流程
- 同时编辑多个节点
- 快速切换语言

#### 测试用例 14: 内存压力
- 创建并删除 1000 个节点
- 监控内存使用情况

## 自动化测试脚本

见 `tests/run-all-tests.ts`